"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4711],{4711:(y,_,u)=>{u.r(_),u.d(_,{Tab1PageModule:()=>C});var r=u(7863),f=u(177),p=u(4341),v=u(1307),b=u(8986),g=u(467),e=u(4438),F=u(7596),T=u(6699);function k(i,c){if(1&i){const l=e.RV6();e.j41(0,"div",40)(1,"ion-button",41),e.bIt("click",function(){e.eBV(l);const a=e.XpG();return e.Njj(a.clearFilter())}),e.EFF(2," Limpar Filtro "),e.k0s()()}}function j(i,c){if(1&i){const l=e.RV6();e.j41(0,"ion-item",27)(1,"ion-button",43),e.bIt("click",function(){const a=e.eBV(l).$implicit,n=e.XpG(2);return e.Njj(n.verGarantia(a.nome))}),e.EFF(2),e.k0s(),e.j41(3,"ion-checkbox",44),e.bIt("ionChange",function(){const a=e.eBV(l).$implicit,n=e.XpG(2);return e.Njj(n.toggleSelection(a))}),e.k0s(),e.j41(4,"ion-button",45),e.bIt("click",function(){const a=e.eBV(l).$implicit,n=e.XpG(2);return e.Njj(n.removeGarantia(a))}),e.nrm(5,"ion-icon",46),e.k0s()()}if(2&i){const l=c.$implicit,t=e.XpG(2);e.R7$(2),e.SpI(" ",l.nome," "),e.R7$(),e.Y8G("checked",t.garantiasSelecionadas.includes(l))}}function G(i,c){if(1&i&&(e.qex(0),e.DNE(1,j,6,2,"ion-item",42),e.bVm()),2&i){const l=e.XpG();e.R7$(),e.Y8G("ngForOf",l.filteredGarantias)}}function P(i,c){1&i&&(e.j41(0,"ion-item",47)(1,"ion-label"),e.EFF(2,"N\xe3o existem garantias"),e.k0s()())}const E=[{path:"",component:(()=>{var i;class c{constructor(t,a,n,s,o,d){this.router=t,this.garantiasService=a,this.modalController=n,this.notificacaoService=s,this.toastController=o,this.alertController=d,this.garantias=[],this.filteredGarantias=[],this.garantiasSelecionadas=[],this.novaGarantia={nome:"",modelo:"",dataCompra:"",dataExpiracao:"",observacoes:"",foto:""},this.selectedFilter=null,this.selectedNotificationPeriod=null,this.showFilterOptions=!1,this.searchTerm=""}ngOnInit(){this.garantiasService.getGarantiasObservable().subscribe(t=>{this.garantias=t,this.filteredGarantias=t})}ionViewWillEnter(){this.loadGarantias()}ionViewWillLeave(){this.garantiasSelecionadas=[]}loadGarantias(){var t=this;return(0,g.A)(function*(){t.garantias=yield t.garantiasService.getGarantias(),t.applyFilter()})()}removeGarantia(t){var a=this;return(0,g.A)(function*(){const n=function(){var s=(0,g.A)(function*(){yield a.garantiasService.removeGarantia(t),a.loadGarantias()});return function(){return s.apply(this,arguments)}}();yield a.presentAlertConfirm("Tem a certeza de que deseja remover esta garantia?",n)})()}removeGarantias(){var t=this;return(0,g.A)(function*(){const a=function(){var n=(0,g.A)(function*(){yield t.garantiasService.removeGarantias(t.garantiasSelecionadas),t.loadGarantias(),t.garantiasSelecionadas=[]});return function(){return n.apply(this,arguments)}}();yield t.presentAlertConfirm("Tem a certeza de que deseja remover todas as garantias selecionadas?",a)})()}addGarantia(){var t=this;return(0,g.A)(function*(){t.novaGarantia&&(yield t.garantiasService.addGarantia(t.novaGarantia),t.novaGarantia={nome:"",modelo:"",dataCompra:"",dataExpiracao:"",observacoes:"",foto:""},t.loadGarantias())})()}onSearch(t){this.searchTerm=t.detail.value.toLowerCase(),this.applyFilter()}toggleSelection(t){const a=this.garantiasSelecionadas.indexOf(t);a>-1?this.garantiasSelecionadas.splice(a,1):this.garantiasSelecionadas.push(t)}selectAll(){this.garantiasSelecionadas=this.garantiasSelecionadas.length===this.filteredGarantias.length?[]:[...this.filteredGarantias]}toggleFilterOptions(){this.showFilterOptions=!this.showFilterOptions}openFilterOptions(){this.showFilterOptions=!0}closeFilterOptions(){this.showFilterOptions=!1}setFilter(t){this.selectedFilter=t,this.applyFilter()}clearFilter(){var t=this;return(0,g.A)(function*(){t.selectedFilter=null,yield t.loadGarantias()})()}applyFilter(){let t=[...this.garantias];if(null!==this.selectedFilter){const a=new Date;t=t.filter(n=>{var s;const o=new Date(n.dataExpiracao),d=Math.abs(o.getTime()-a.getTime());return Math.ceil(d/2592e6)<=(null!==(s=this.selectedFilter)&&void 0!==s?s:0)})}this.searchTerm&&(t=t.filter(a=>a.nome.toLowerCase().includes(this.searchTerm))),this.filteredGarantias=t}setNotificationPeriod(t){var a=this;return(0,g.A)(function*(){if(a.selectedNotificationPeriod=t,t&&a.garantiasSelecionadas.length>0){const n=new Date;a.garantiasSelecionadas.filter(o=>{const d=new Date(o.dataExpiracao),m=Math.abs(d.getTime()-n.getTime()),h=Math.ceil(m/864e5);return console.log(h),h>=t&&h>0}).forEach(function(){var o=(0,g.A)(function*(d){const m=new Date(d.dataExpiracao),h=new Date(m.getTime()-24*t*60*60*1e3);(yield a.notificacaoService.sendNotificacao(`Garantia Expirando: ${d.nome}`,`A garantia do produto ${d.nome} est\xe1 expirando em breve. Verifique os detalhes.`,h))?a.presentToast(`Notifica\xe7\xe3o agendada para: ${d.nome}`,"success"):a.presentToast(`Falha ao agendar notifica\xe7\xe3o para: ${d.nome}`,"danger")});return function(d){return o.apply(this,arguments)}}())}})()}presentToast(t,a){var n=this;return(0,g.A)(function*(){(yield n.toastController.create({message:t,duration:2e3,color:a})).present()})()}goAddGarantiaPage(){this.router.navigateByUrl("/add-garantia")}verGarantia(t){const a=encodeURIComponent(t);this.router.navigateByUrl(`/ver-garantia/${a}`)}presentAlertConfirm(t,a){var n=this;return(0,g.A)(function*(){yield(yield n.alertController.create({header:"Confirmar Remo\xe7\xe3o",message:t,buttons:[{text:"Cancelar",role:"cancel",handler:()=>{console.log("Remo\xe7\xe3o cancelada")}},{text:"Remover",handler:a}]})).present()})()}}return(i=c).\u0275fac=function(t){return new(t||i)(e.rXU(b.Ix),e.rXU(F.i),e.rXU(r.W3),e.rXU(T.S),e.rXU(r.K_),e.rXU(r.hG))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-tab1"]],decls:61,vars:7,consts:[["selectFilterOptions",""],["selectNotify",""],["emptyList",""],[1,"custom-background",3,"fullscreen"],[1,"ion-text-center","title-container"],[1,"black-text","custom-font",2,"font-size","2.5rem"],["placeholder","Nome Da Garantia","show-clear-button","always",1,"round-searchbar",3,"ionInput"],[2,"display","flex"],[1,"ion-margin-start",3,"click"],[1,"back-color","black-text","button-border"],["slot","end","name","caret-down-outline"],[3,"click"],[1,"back-color","black-text","button-border",3,"disabled"],["name","notifications-outline"],["class","ion-margin-start",4,"ngIf"],["interface","action-sheet","placeholder","Filtrar Por Dura\xe7\xe3o","cancelText","Cancelar",2,"display","none",3,"ngModelChange","ionChange","ngModel"],["value","1"],["value","3"],["value","6"],["value","12"],["interface","action-sheet","placeholder","Notify","cancelText","Cancelar",2,"display","none",3,"ionChange"],["value","7"],["value","15"],["value","30"],["value","90"],[1,"back-color"],[1,"fixed-height-list","back-color"],[1,""],[2,"font-size","20px"],[4,"ngIf","ngIfElse"],[1,"ion-margin-bottom"],["vertical","bottom","horizontal","end","slot","fixed",1,"fab-button-custom",2,"margin-right","20px","margin-bottom","10px"],["color","yellow",1,"bigger-icon",3,"click"],["name","add","size","large"],[2,"margin-left","10px"],["shape","round",1,"back-select",3,"click"],[1,"black-text"],["shape","round",1,"back-delete",3,"click","disabled"],["slot","icon-only","name","trash-outline","color","back-color",1,"custom-trash-button",2,"margin-left","10px"],[2,"margin-left","10px","margin-right","10px"],[1,"ion-margin-start"],["fill","clear",1,"back-color","black-text","button-border",3,"click"],["class","",4,"ngFor","ngForOf"],["expand","Block","shape","round",1,"button-border","back-color","black-text","custom-button",3,"click"],["slot","end",3,"ionChange","checked"],["slot","end","fill","inline",3,"click"],["slot","icon-only","name","trash-outline",1,"custom-trash-button","icon-delete"],[1,"empty-list-item"]],template:function(t,a){if(1&t){const n=e.RV6();e.j41(0,"ion-content",3)(1,"div",4)(2,"h1",5),e.EFF(3,"Garantes"),e.k0s()(),e.j41(4,"div")(5,"ion-searchbar",6),e.bIt("ionInput",function(o){return e.eBV(n),e.Njj(a.onSearch(o))}),e.k0s()(),e.j41(6,"div",7)(7,"div",8),e.bIt("click",function(){e.eBV(n);const o=e.sdS(19);return e.Njj(o.open())}),e.j41(8,"ion-button",9)(9,"b"),e.EFF(10,"Filtrar Por Dura\xe7\xe3o"),e.k0s(),e.nrm(11,"ion-icon",10),e.k0s()(),e.j41(12,"div")(13,"div",11),e.bIt("click",function(){e.eBV(n);const o=e.sdS(29);return e.Njj(a.garantiasSelecionadas.length>0?o.open():null)}),e.j41(14,"ion-button",12),e.nrm(15,"ion-icon",13)(16,"ion-icon",10),e.k0s()()(),e.DNE(17,k,3,0,"div",14),e.k0s(),e.j41(18,"ion-select",15,0),e.mxI("ngModelChange",function(o){return e.eBV(n),e.DH7(a.selectedFilter,o)||(a.selectedFilter=o),e.Njj(o)}),e.bIt("ionChange",function(o){return e.eBV(n),e.Njj(a.setFilter(o.detail.value))}),e.j41(20,"ion-select-option",16),e.EFF(21,"Dura\xe7\xe3o menos de 1 m\xeas"),e.k0s(),e.j41(22,"ion-select-option",17),e.EFF(23,"Dura\xe7\xe3o menos de 3 meses"),e.k0s(),e.j41(24,"ion-select-option",18),e.EFF(25,"Dura\xe7\xe3o menos de 6 meses"),e.k0s(),e.j41(26,"ion-select-option",19),e.EFF(27,"Dura\xe7\xe3o menos de 1 ano"),e.k0s()(),e.j41(28,"ion-select",20,1),e.bIt("ionChange",function(o){return e.eBV(n),e.Njj(a.setNotificationPeriod(o.detail.value))}),e.j41(30,"ion-select-option",21),e.EFF(31,"Agendar notifica\xe7\xf5es para quando o prazo de validade atingir 7 dias"),e.k0s(),e.j41(32,"ion-select-option",22),e.EFF(33,"Agendar notifica\xe7\xf5es para quando o prazo de validade atingir 15 dias"),e.k0s(),e.j41(34,"ion-select-option",23),e.EFF(35,"Agendar notifica\xe7\xf5es para quando o prazo de validade atingir 30 dias"),e.k0s(),e.j41(36,"ion-select-option",24),e.EFF(37,"Agendar notifica\xe7\xf5es para quando o prazo de validade atingir 90 dias"),e.k0s()(),e.j41(38,"div")(39,"ion-card",25)(40,"ion-list",26)(41,"ion-list-header",27)(42,"ion-label",28)(43,"b"),e.EFF(44,"Garantias"),e.k0s()()(),e.DNE(45,G,2,1,"ng-container",29)(46,P,3,0,"ng-template",null,2,e.C5r),e.k0s()()(),e.j41(48,"div",30)(49,"ion-fab",31)(50,"ion-fab-button",32),e.bIt("click",function(){return e.eBV(n),e.Njj(a.goAddGarantiaPage())}),e.nrm(51,"ion-icon",33),e.k0s()()(),e.j41(52,"div",34)(53,"ion-button",35),e.bIt("click",function(){return e.eBV(n),e.Njj(a.selectAll())}),e.j41(54,"ion-label",36),e.EFF(55,"Selecionar Tudo"),e.k0s()()(),e.j41(56,"div",34)(57,"ion-button",37),e.bIt("click",function(){return e.eBV(n),e.Njj(a.removeGarantias())}),e.nrm(58,"ion-icon",38),e.j41(59,"ion-label",39),e.EFF(60,"Selecionados"),e.k0s()()()()}if(2&t){const n=e.sdS(47);e.Y8G("fullscreen",!0),e.R7$(14),e.Y8G("disabled",0===a.garantiasSelecionadas.length),e.R7$(3),e.Y8G("ngIf",a.selectedFilter),e.R7$(),e.R50("ngModel",a.selectedFilter),e.R7$(27),e.Y8G("ngIf",a.filteredGarantias.length>0)("ngIfElse",n),e.R7$(12),e.Y8G("disabled",0===a.garantiasSelecionadas.length)}},dependencies:[r.Jm,r.b_,r.eY,r.W9,r.Q8,r.YW,r.iq,r.uz,r.he,r.nf,r.AF,r.S1,r.Nm,r.Ip,r.hB,r.Je,r.Gw,f.Sq,f.bT,p.BC,p.vS],styles:['@charset "UTF-8";.custom-button[_ngcontent-%COMP%]{height:40px;font-size:16px}.custom-trash-button[_ngcontent-%COMP%]{height:25px;width:25px}.list-container[_ngcontent-%COMP%]{height:500px;overflow-y:auto}.fab-button-custom[_ngcontent-%COMP%]{bottom:70px;margin-left:20px}.fixed-height-list[_ngcontent-%COMP%]{height:calc(85vh - 240px);overflow-y:auto}.empty-list-item[_ngcontent-%COMP%]{text-align:center;width:100%;font-size:1.2rem;color:#666}.bigger-icon[_ngcontent-%COMP%]{width:75px;height:75px}.back-delete[_ngcontent-%COMP%]{--background: #e40000}.icon-delete[_ngcontent-%COMP%]{color:#e40000}.back-select[_ngcontent-%COMP%]{--background: var(--ion-color-yellow)}']}),c})()}];let x=(()=>{var i;class c{}return(i=c).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[b.iI.forChild(E),b.iI]}),c})(),C=(()=>{var i;class c{}return(i=c).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[r.bv,f.MD,p.YN,v.S,x]}),c})()}}]);